SELECT
PRODUCT.PRODUCTID,
PRODUCT.NAME,
YEAR(SALESORDERHEADER.ORDERDATE) AS ORDERYEAR,
SUM(SALESORDERDETAIL.ORDERQTY) AS ORDERQUANTITY
FROM SALES.SALESORDERDETAIL
INNER JOIN PRODUCTION.PRODUCT
ON SALESORDERDETAIL.PRODUCTID=PRODUCT.PRODUCTID
INNER JOIN SALES.SALESORDERHEADER
ON SALESORDERDETAIL.SALESORDERID=SALESORDERHEADER.SALESORDERID
GROUP BY PRODUCT.PRODUCTID,PRODUCT.NAME,YEAR(SALESORDERHEADER.ORDERDATE)